pub const PK_RSA_ENC: i64 = 0;
pub const PK_SECP256R: i64 = 1;
pub const PK_SECP384R: i64 = 2;
pub const PK_SECP521R: i64 = 3;
pub const PK_X25519: i64 = 8;
pub const PK_X448: i64 = 9;
pub const PK_ED25519: i64 = 10;
pub const PK_ED448: i64 = 11;
pub const PK_HSS_LMS: i64 = 16;
pub const PK_XMSS: i64 = 17;
pub const PK_XMSS_MT: i64 = 18;
pub const PK_BRAINPOOL256R1: i64 = 24;
pub const PK_BRAINPOOL384R1: i64 = 25;
pub const PK_BRAINPOOL512R1: i64 = 26;
pub const PK_FRP256V1: i64 = 27;
pub const PK_SM2P256V1: i64 = 28; //06 07 2A 86 48 CE 3D 02 01 06 08 2A 81 1C CF 55 01 82 2D
pub fn pk_map(alg_id: &[u8]) -> Option<i64> {
    let value = lder(alg_id, ASN1_SEQ);
    match value {
        [0x06, 0x03, 0x2B, 0x65, ..] => match value[4..] {
            [0x6E] => Some(PK_X25519),
            [0x6F] => Some(PK_X448),
            [0x70] => Some(PK_ED25519),
            [0x71] => Some(PK_ED448),
            _ => None,
        },
        [0x06, 0x07, 0x2A, 0x86, 0x48, 0xCE, 0x3D, 0x02, 0x01, ..] => match lder(&value[9..], ASN1_OID) {
            [0x2A, 0x81, 0x7A, 0x01, 0x81, 0x5F, 0x65, 0x82, 0x00, 0x01] => Some(PK_FRP256V1),
            [0x2A, 0x81, 0x1C, 0xCF, 0x55, 0x01, 0x82, 0x2D] => Some(PK_SM2P256V1),
            [0x2A, 0x86, 0x48, 0xCE, 0x3D, 0x03, 0x01, 0x07] => Some(PK_SECP256R),
            [0x2B, 0x81, 0x04, 0x00, 0x22] => Some(PK_SECP384R),
            [0x2B, 0x81, 0x04, 0x00, 0x23] => Some(PK_SECP521R),
            [0x2B, 0x24, 0x03, 0x03, 0x02, 0x08, 0x01, 0x01, 0x07] => Some(PK_BRAINPOOL256R1),
            [0x2B, 0x24, 0x03, 0x03, 0x02, 0x08, 0x01, 0x01, 0x0B] => Some(PK_BRAINPOOL384R1),
            [0x2B, 0x24, 0x03, 0x03, 0x02, 0x08, 0x01, 0x01, 0x0D] => Some(PK_BRAINPOOL512R1),
            _ => None,
        },
        [0x06, 0x09, 0x04, 0x00, 0x7F, 0x00, 0x0F, 0x01, 0x01, ..] => match value[4..] {
            [0x0D, 0x00] => Some(PK_XMSS),
            [0x0E, 0x00] => Some(PK_XMSS_MT),
            _ => None,
        },
        [0x06, 0x09, 0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x01, 0x01, 0x05, 0x00] => Some(PK_RSA_ENC),
        [0x06, 0x0B, 0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x09, 0x10, 0x03, 0x11] => Some(PK_HSS_LMS),
        _ => None,
    }
}
